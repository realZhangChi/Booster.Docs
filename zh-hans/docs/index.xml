<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Maui.Toolkit – 文档</title><link>https://docs.mauitoolkit.com/zh-hans/docs/</link><description>Recent content in 文档 on Maui.Toolkit</description><generator>Hugo -- gohugo.io</generator><atom:link href="https://docs.mauitoolkit.com/zh-hans/docs/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: 简介</title><link>https://docs.mauitoolkit.com/zh-hans/docs/toolkits/wechat/overview/</link><pubDate>Thu, 14 Oct 2021 00:00:00 +0000</pubDate><guid>https://docs.mauitoolkit.com/zh-hans/docs/toolkits/wechat/overview/</guid><description>
&lt;div class="pageinfo pageinfo-primary">
&lt;p>此文档将介绍如何通过 Maui.Toolkit.WeChat 来使用微信开放平台功能。微信开放平台的详细资料及流程原理等参见&lt;a href='https://developers.weixin.qq.com/doc/oplatform/Mobile_App/Resource_Center_Homepage.html' target='_blank'>微信开放平台官方文档&lt;/a>。&lt;/p>
&lt;/div>
&lt;p>Maui.Toolkit.WeChat 为微信官方的SDK创建了绑定类库，以原生的方式集成了微信的功能。&lt;/p>
&lt;p>Maui.Toolkit.WeChat 将微信开放平台的功能抽象成为接口，并为不同的平台提供了默认的实现，只需调用Maui.Toolkit.WeChat 定义的接口即可使用微信开放平台的功能，使你无需处理繁琐的特定平台的操作。&lt;/p>
&lt;p>微信开放平台支持移动应用和网页应用的对接。在 Maui.Toolkit.WeChat 中，对于Android和iOS等移动端，将采用移动应用的方式；对于Windows及Mac等桌面端，将采用网页应用的方式。&lt;/p>
&lt;h2 id="下一步">下一步&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.mauitoolkit.com/docs/toolkits/wechat/get-started/">开始使用&lt;/a>：轻松配置并开始使用 Maui.Toolkit.WeChat&lt;/li>
&lt;/ul></description></item><item><title>Docs: 开始使用</title><link>https://docs.mauitoolkit.com/zh-hans/docs/toolkits/wechat/get-started/</link><pubDate>Thu, 14 Oct 2021 00:00:00 +0000</pubDate><guid>https://docs.mauitoolkit.com/zh-hans/docs/toolkits/wechat/get-started/</guid><description>
&lt;h2 id="前提条件">前提条件&lt;/h2>
&lt;p>已经通过&lt;a href="https://open.weixin.qq.com/cgi-bin/index?t=home/index&amp;lang=zh_CN" target="_blank">微信开放平台&lt;/a>创建移动应用及网页应用，并获取他们的&lt;strong>AppId&lt;/strong>和&lt;strong>AppSecret&lt;/strong>。&lt;/p>
&lt;h2 id="引用">引用&lt;/h2>
&lt;p>&lt;em>TODO: 添加Nuget包引用。&lt;/em>&lt;/p>
&lt;h2 id="配置">配置&lt;/h2>
&lt;p>在您的Maui项目中的&lt;code>MauiProgram.cs&lt;/code>中添加少量的代码即可开始使用Maui.Toolkit.WeChat：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-C#" data-lang="C#">&lt;span style="color:#204a87;font-weight:bold">public&lt;/span> &lt;span style="color:#204a87;font-weight:bold">static&lt;/span> &lt;span style="color:#204a87;font-weight:bold">class&lt;/span> &lt;span style="color:#000">MauiProgram&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">public&lt;/span> &lt;span style="color:#204a87;font-weight:bold">static&lt;/span> &lt;span style="color:#000">MauiApp&lt;/span> &lt;span style="color:#000">CreateMauiApp&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">var&lt;/span> &lt;span style="color:#000">builder&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#000">MauiApp&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">CreateBuilder&lt;/span>&lt;span style="color:#000;font-weight:bold">();&lt;/span>
&lt;span style="color:#000">builder&lt;/span>
&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">UseMauiApp&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">App&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;()&lt;/span>
&lt;span style="color:#8f5902;font-style:italic">// 添加以下代码
&lt;/span>&lt;span style="color:#8f5902;font-style:italic">&lt;/span> &lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">UseWeChat&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">new&lt;/span> &lt;span style="color:#000">WeChatWebOptions&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">AppId&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;网页应用的AppId&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">AppSecret&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;网页应用的AppSecret&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">RedirectUrl&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;网页应用的授权回调地址&amp;#34;&lt;/span>
&lt;span style="color:#000;font-weight:bold">},&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">new&lt;/span> &lt;span style="color:#000">WeChatMobileOptions&lt;/span>&lt;span style="color:#000;font-weight:bold">()&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">AppId&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;移动应用的AppId&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span>
&lt;span style="color:#000">AppSecret&lt;/span> &lt;span style="color:#000;font-weight:bold">=&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;移动应用的AppSecret&amp;#34;&lt;/span>
&lt;span style="color:#000;font-weight:bold">})&lt;/span>
&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">ConfigureFonts&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#000">fonts&lt;/span> &lt;span style="color:#000;font-weight:bold">=&amp;gt;&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000">fonts&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">AddFont&lt;/span>&lt;span style="color:#000;font-weight:bold">(&lt;/span>&lt;span style="color:#4e9a06">&amp;#34;OpenSans-Regular.ttf&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">,&lt;/span> &lt;span style="color:#4e9a06">&amp;#34;OpenSansRegular&amp;#34;&lt;/span>&lt;span style="color:#000;font-weight:bold">);&lt;/span>
&lt;span style="color:#000;font-weight:bold">});&lt;/span>
&lt;span style="color:#000">builder&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Services&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">AddSingleton&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;lt;&lt;/span>&lt;span style="color:#000">MainPage&lt;/span>&lt;span style="color:#000;font-weight:bold">&amp;gt;();&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">return&lt;/span> &lt;span style="color:#000">builder&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Build&lt;/span>&lt;span style="color:#000;font-weight:bold">();&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;p>为使您的应用正常与微信进行交互，需针对移动平台进行配置：&lt;/p>
&lt;ul class="nav nav-tabs" id="tabs-0" role="tablist">&lt;li class="nav-item">&lt;a class="nav-link active"
id="tabs-0-android-tab" data-toggle="tab" href="#tabs-0-android" role="tab"
aria-controls="tabs-0-android" aria-selected="true">
Android
&lt;/a>
&lt;/li>&lt;li class="nav-item">&lt;a class="nav-link"
id="tabs-0-ios-tab" data-toggle="tab" href="#tabs-0-ios" role="tab"
aria-controls="tabs-0-ios" aria-selected="false">
iOS
&lt;/a>
&lt;/li>&lt;/ul>
&lt;div class="tab-content" id="tabs-0-content">
&lt;div class="tab-pane fade show active" id="tabs-0-android" role="tabpanel" aria-labelled-by="tabs-0-android-tab">
&lt;br />&lt;ol>
&lt;li>
&lt;p>在你的Maui项目的&lt;code>/Platforms/Android/&lt;/code>目录下新建文件夹，命名为&lt;code>WeChatApi&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>在&lt;code>WeChatApi&lt;/code>目录下新建类文件&lt;code>WeChatEntryActivity.cs&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>更改&lt;code>WeChatEntryActivity.cs&lt;/code>的代码如下：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4">&lt;code class="language-C#" data-lang="C#">&lt;span style="color:#c4a000">[Activity(
&lt;/span>&lt;span style="color:#c4a000"> Name = &amp;#34;Maui.Toolkit.Sample.WeChatApi.WeChatEntryActivity&amp;#34;,
&lt;/span>&lt;span style="color:#c4a000"> Exported = true,
&lt;/span>&lt;span style="color:#c4a000"> TaskAffinity = &amp;#34;Maui.Toolkit.Sample&amp;#34;,
&lt;/span>&lt;span style="color:#c4a000"> LaunchMode = LaunchMode.SingleTask)]&lt;/span>
&lt;span style="color:#204a87;font-weight:bold">public&lt;/span> &lt;span style="color:#204a87;font-weight:bold">class&lt;/span> &lt;span style="color:#000">WeChatEntryActivity&lt;/span> &lt;span style="color:#000;font-weight:bold">:&lt;/span> &lt;span style="color:#000">WeChat&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Platforms&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">Android&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WeChatApi&lt;/span>&lt;span style="color:#000;font-weight:bold">.&lt;/span>&lt;span style="color:#000">WeChatEntryActivity&lt;/span>
&lt;span style="color:#000;font-weight:bold">{&lt;/span>
&lt;span style="color:#000;font-weight:bold">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;/div>
&lt;div class="tab-pane fade" id="tabs-0-ios" role="tabpanel" aria-labelled-by="tabs-0-ios-tab">
&lt;br />&lt;p>&lt;em>TODO&lt;/em>&lt;/p>
&lt;/div>
&lt;/div>
&lt;h2 id="下一步">下一步&lt;/h2>
&lt;p>以上就是使用Maui.Toolkit.WeChat所需的全部配置，注入服务并开始使用吧！&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.mauitoolkit.com/docs/toolkits/wechat/login/">登录&lt;/a>: 通过微信登录您的应用&lt;/li>
&lt;/ul></description></item><item><title>Docs: 登录</title><link>https://docs.mauitoolkit.com/zh-hans/docs/toolkits/wechat/login/</link><pubDate>Thu, 28 Oct 2021 12:19:52 +0000</pubDate><guid>https://docs.mauitoolkit.com/zh-hans/docs/toolkits/wechat/login/</guid><description>
&lt;div class="pageinfo pageinfo-primary">
&lt;p>此文档将介绍如何使用 Maui.Toolkit.WeChat 来调用微信登录等功能。微信登录功能的详细文档参见&lt;a href='[https://developers.weixin.qq.com/doc/oplatform/Mobile_App/WeChat_Login/Development_Guide.html](https://developers.weixin.qq.com/doc/oplatform/Mobile_App/WeChat_Login/Development_Guide.html "https://developers.weixin.qq.com/doc/oplatform/Mobile_App/WeChat_Login/Development_Guide.html")' target='_blank'>微信开放文档&lt;/a>。&lt;/p>
&lt;/div>
&lt;h2 id="登录">登录&lt;/h2>
&lt;p>在移动应用中，调用微信登录将唤起微信APP并请求用户授权；在桌面应用中，将访问微信网页应用授权网址以展示二维码。&lt;/p>
&lt;p>Maui.Toolkit.WeChat 在&lt;code>IAuthorizationService&lt;/code>接口中定义了微信登录，它位于&lt;code>Maui.Toolkit.WeChat.Services.Identity&lt;/code>名称空间。注入接口&lt;code>IAuthorizationService&lt;/code>并调用&lt;code>AuthorizeAsync()&lt;/code>，即可唤起微信登录。&lt;/p>
&lt;pre>&lt;code>public partial class MainPage : ContentPage
{
private readonly IAuthorizationService _authorizationService;
public MainPage(IAuthorizationService authorizationService)
{
_authorizationService = authorizationService;
}
private async void OnAuthorizeClicked(object sender, EventArgs e)
{
await _authorizationService.AuthorizeAsync();
}
}
&lt;/code>&lt;/pre>
&lt;p>用户在微信中授权后，微信会携带授权码进行回调。Maui.Toolkit已实现微信回调功能，自动获取&lt;code>Token&lt;/code>和个人信息&lt;code>UserInfo&lt;/code>。&lt;code>Token&lt;/code>和&lt;code>UserInfo&lt;/code>都将存储在设备安全存储空间中。&lt;/p>
&lt;h2 id="token">Token&lt;/h2>
&lt;p>Maui.Toolkit中定义并实现了ITokenStore接口。在使用Maui.Toolkit进行微信登录后，即可在任意位置注入接口并调用&lt;code>GetOrNullAsync&lt;/code>方法，获取到用户信息&lt;code>UserInfo&lt;/code>实例。&lt;/p>
&lt;pre>&lt;code>public partial class MainPage : ContentPage
{
private readonly ITokenStore _tokenStore;
public MainPage(ITokenStore tokenStore)
{
_tokenStore = tokenStore;
}
public async Task&amp;lt;Token&amp;gt; GetToken()
{
return await _tokenStore.GetOrNullAsync();
}
}
&lt;/code>&lt;/pre>
&lt;h2 id="用户信息">用户信息&lt;/h2>
&lt;p>Maui.Toolkit中定义并实现了&lt;code>IUserInfoStore&lt;/code>接口。在使用Maui.Toolkit进行微信登录后，即可在任意位置注入接口并调用&lt;code>GetOrNullAsync&lt;/code>方法，获取到用户信息&lt;code>UserInfo&lt;/code>实例。&lt;/p>
&lt;pre>&lt;code>public partial class UserInfoPage : ContentPage
{
private readonly IUserInfoStore _userInfoStore;
public UserInfoPage(IUserInfoStore userInfoStore)
{
_userInfoStore = userInfoStore;
}
public async Task&amp;lt;UserInfo&amp;gt; GetUserInfo()
{
return await _userInfoStore.GetOrNullAsync();
}
}
&lt;/code>&lt;/pre>
&lt;h2 id="自定义">自定义&lt;/h2>
&lt;p>Maui.Toolkit.WeChat已默认实现了微信登录的相关功能，一般情况下，只需注入并调用接口即可。当需要更复杂的处理的时候，可以轻松对服务进行扩展或替换为自定义实现。&lt;/p></description></item></channel></rss>